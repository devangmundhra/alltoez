<VirtualHost *:81>
    ServerName projectname.alltoez.co.uk
    ServerAlias projectname.alltoez.co.uk

    WSGIDaemonProcess projectname user=alltoez group=alltoez threads=10 python-path=/home/alltoez/sites/projectname/env/lib/python2.6/site-packages
    WSGIProcessGroup projectname
    WSGIScriptAlias / /home/alltoez/sites/projectname/repository/projectname/configs/staging/staging.wsgi

    ErrorLog /home/alltoez/logs/projectname.error.log
    LogLevel warn

    CustomLog /home/alltoez/logs/projectname.access.log combined

    ServerSignature Off

    RewriteEngine On

    # We want www.example.com to forward to example.com
    RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
    RewriteRule ^(.*)/$ http://%1/$1 [R=301,L]

    # If a user accessed the site when maintenance was up, redirect to index
    RewriteCond %{REQUEST_URI} /maintenance.html$
    RewriteRule $ / [R=302,L]

    <Location />
        Deny from all
        AuthUserFile /home/alltoez/sites/projectname/repository/projectname/configs/staging/vhost.htpasswd
        AuthName "projectname staging website"
        AuthType Basic
        Satisfy Any
        Require valid-user
    </Location>
</VirtualHost>
